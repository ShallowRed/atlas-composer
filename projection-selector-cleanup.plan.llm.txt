# Projection Selector Cleanup - Implementation Plan

## Objective
Remove unused search/recommendation features, merge ProjectionSelector with ProjectionDropdown, and update badge system to use single Remix icons instead of multiple plus signs.

## Investigation Results

### Deleted/Unused Symbols Analysis
Based on code investigation:

1. **useProjectionFiltering composable** (src/composables/useProjectionFiltering.ts)
   - Used ONLY in ProjectionSelector.vue (2 usages)
   - Provides: searchQuery, isSearching, filteredProjectionGroups, toggleSearch, clearSearch
   - Status: Can be DELETED (search feature removed)

2. **ProjectionSearchBar component** (src/components/ui/projections/ProjectionSearchBar.vue)
   - Usage: NOT USED anywhere in codebase
   - Status: Can be DELETED

3. **useProjectionRecommendations composable** (src/composables/useProjectionRecommendations.ts)
   - Used in: ProjectionDropdown.vue (2 usages), ProjectionRecommendationBadge.vue (2 usages)
   - Provides: getBadge(), getCssClass(), getTooltip(), getRecommendation()
   - Current badge system: '+++' (excellent), '++' (good), '+' (usable)
   - Status: KEEP but REFACTOR badge system to use Remix icons

4. **ProjectionRecommendationBadge component** (src/components/ui/projections/ProjectionRecommendationBadge.vue)
   - Usage: NOT USED anywhere (badges are inline in DropdownControl via props)
   - Status: Can be DELETED

5. **ProjectionSelector.vue** (src/components/ui/projections/ProjectionSelector.vue)
   - Wrapper around ProjectionDropdown with info button
   - Adds: info modal, validation logic (unused), confirmation dialog (unused)
   - Status: MERGE with ProjectionDropdown

6. **ProjectionDropdown.vue** (src/components/ui/projections/ProjectionDropdown.vue)
   - Simple wrapper around DropdownControl
   - Adds: loading skeleton, badge transformation
   - Status: Merge INTO (keep this as base)

## Affected Domains
- [ ] Vue Components (docs/vue-architecture.llm.txt)
- [ ] Composables system

## Context
- Architecture: docs/architecture.llm.txt
- Vue layer: docs/vue-architecture.llm.txt

## Changes

### Phase 1: Update Badge System
- [ ] src/composables/useProjectionRecommendations.ts
  - Update getBadge() to return Remix icon class names:
    - 'excellent' → 'ri-star-fill' (filled star)
    - 'good' → 'ri-star-line' (outlined star)
    - 'usable' → 'ri-star-half-line' (half star)
    - 'not-recommended' → '' (no icon)
  - Update getCssClass() color mapping:
    - 'excellent' → 'text-success'
    - 'good' → 'text-info'
    - 'usable' → 'text-base-content opacity-60'
    - 'not-recommended' → '' (no class)
  - Keep getTooltip() and getRecommendation() unchanged

### Phase 2: Update DropdownControl Badge Display
- [ ] src/components/ui/forms/DropdownControl.vue
  - Check how badges are currently displayed (need to read full file)
  - Update badge rendering to support icon classes (if string starts with 'ri-')
  - Position badge icon to LEFT of projection name
  - Ensure consistent styling across button and menu items

### Phase 3: Merge ProjectionSelector into ProjectionDropdown
- [ ] src/components/ui/projections/ProjectionDropdown.vue
  - Add info button functionality from ProjectionSelector
  - Add ProjectionInfo modal from ProjectionSelector
  - Add props: label (string, required)
  - Remove: loading skeleton logic (move to parent if needed)
  - Keep: badge transformation with updated icon system
  - Remove dependency on useProjectionFiltering (no more filtering)
  - Result: Single component that combines dropdown + info button

### Phase 4: Update Component Usages
- [ ] Find all usages of ProjectionSelector
  - Search codebase for imports and usage
  - Replace with ProjectionDropdown
  - Update props as needed

### Phase 5: Delete Unused Files
- [ ] Delete src/composables/useProjectionFiltering.ts
- [ ] Delete src/components/ui/projections/ProjectionSearchBar.vue
- [ ] Delete src/components/ui/projections/ProjectionRecommendationBadge.vue
- [ ] Delete src/components/ui/projections/ProjectionSelector.vue (after merge)

### Phase 6: Update Type Definitions
- [ ] src/types/composables.ts
  - Remove ProjectionFilteringReturn type (if exists)
  - Check for any other projection-related types that need updating

## Documentation Updates - [x] COMPLETE
- [x] docs/vue-architecture.llm.txt
  - Removed ProjectionSearchBar from component list
  - Removed ProjectionRecommendationBadge from component list
  - Updated ProjectionSelector → ProjectionDropdown (merged component)
  - Updated ProjectionDropdown description to include info button
  - Removed useProjectionFiltering from composables section
  - Updated useProjectionRecommendations description with new icon system
  - Updated DropdownControl badge support documentation (Remix icons instead of text)

## Verification
- [x] Code compiles without errors (pnpm run build)
- [x] All .llm.txt documentation updated
- [ ] App runs correctly (pnpm dev) - User to verify
- [ ] Projection selection works with new badge icons - User to verify
- [ ] Info button opens modal correctly - User to verify
- [ ] Badge icons display to left of projection names - User to verify

## Progress

### Phase 1: Update Badge System - [x] COMPLETE
- [x] src/composables/useProjectionRecommendations.ts - Updated getBadge() to return Remix icon classes
- [x] Updated getCssClass() color mapping

### Phase 2: Update DropdownControl Badge Display - [x] COMPLETE
- [x] src/components/ui/forms/DropdownOptionItem.vue - Support icon badges with CSS classes
- [x] src/components/ui/forms/DropdownSelectedOption.vue - Support icon badges with CSS classes
- [x] src/components/ui/projections/ProjectionDropdown.vue - Apply CSS classes to badge icons

### Phase 3: Merge ProjectionSelector into ProjectionDropdown - [x] COMPLETE
- [x] Merged info button and modal functionality into ProjectionDropdown
- [x] Updated TerritoryControls.vue (2 usages)
- [x] Updated ProjectionParamsControls.vue (1 usage)

### Phase 4: Update Component Usages - [x] COMPLETE
- [x] Replaced all ProjectionSelector imports with ProjectionDropdown

### Phase 5: Delete Unused Files - [x] COMPLETE
- [x] Deleted src/composables/useProjectionFiltering.ts
- [x] Deleted src/components/ui/projections/ProjectionSearchBar.vue
- [x] Deleted src/components/ui/projections/ProjectionRecommendationBadge.vue
- [x] Deleted src/components/ui/projections/ProjectionSelector.vue

### Phase 6: Update Type Definitions - [x] COMPLETE
- [x] Removed ProjectionFiltering interface from src/types/composables.ts
- [x] Removed ProjectionFiltering export from src/types/index.ts

## Status
Status: COMPLETE
Created: 2025-10-11
Completed: 2025-10-11

## Summary
Successfully cleaned up projection selector components and badge system:

### Key Changes
1. Badge System: Replaced text badges (+++, ++, +) with Remix icon badges (ri-star-fill, ri-star-line, ri-star-half-line)
2. Component Consolidation: Merged ProjectionSelector functionality into ProjectionDropdown (single component with info modal)
3. Code Cleanup: Removed 4 unused files and simplified architecture
4. Badge Positioning: Badges now display to the left of projection names throughout the app

### Files Modified
- src/composables/useProjectionRecommendations.ts (badge system update)
- src/components/ui/forms/DropdownOptionItem.vue (icon badge support)
- src/components/ui/forms/DropdownSelectedOption.vue (icon badge support)
- src/components/ui/projections/ProjectionDropdown.vue (merged with ProjectionSelector)
- src/components/TerritoryControls.vue (updated imports and usage)
- src/components/ui/projections/ProjectionParamsControls.vue (updated imports and usage)
- src/types/composables.ts (removed ProjectionFiltering)
- src/types/index.ts (removed ProjectionFiltering export)
- docs/vue-architecture.llm.txt (comprehensive documentation updates)

### Files Deleted
- src/composables/useProjectionFiltering.ts
- src/components/ui/projections/ProjectionSearchBar.vue
- src/components/ui/projections/ProjectionRecommendationBadge.vue
- src/components/ui/projections/ProjectionSelector.vue

### Build Status
Application builds successfully without errors (verified with pnpm build)
