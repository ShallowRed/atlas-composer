# Cartographies de la France avec DOM-TOM

Ce projet permet de cr√©er des visualisations cartographiques de la France m√©tropolitaine et de ses d√©partements et collectivit√©s d'outre-mer (DOM-TOM), en pr√©servant les rapports de taille r√©els entre les territoires.

## üéØ Objectifs

- **Repr√©sentation c√¥te √† c√¥te** : Afficher la m√©tropole et les DOM-TOM de mani√®re adjacente
- **Pr√©servation des √©chelles** : Conserver les rapports de taille r√©els pour montrer la v√©ritable √©tendue de territoires comme la Guyane
- **Projections g√©ographiques avanc√©es** : Utiliser des projections optimis√©es pour chaque territoire
- **Interactivit√©** : Permettre de basculer entre diff√©rentes projections et modes d'affichage

## üõ†Ô∏è Technologies utilis√©es

- **[Vite](https://vitejs.dev/)** : Build tool et serveur de d√©veloppement
- **[TypeScript](https://www.typescriptlang.org/)** : Langage de programmation
- **[Vue.js 3](https://vuejs.org/)** : Framework r√©actif pour l'interface utilisateur
- **[Pinia](https://pinia.vuejs.org/)** : Gestion d'√©tat pour Vue.js
- **[Tailwind CSS](https://tailwindcss.com/)** : Framework CSS utility-first
- **[DaisyUI](https://daisyui.com/)** : Composants UI bas√©s sur Tailwind
- **[Observable Plot](https://observablehq.com/plot/)** : Biblioth√®que de visualisation de donn√©es
- **[D3.js](https://d3js.org/)** : Manipulation des donn√©es g√©ographiques et projections
- **[d3-composite-projections](https://github.com/rveciana/d3-composite-projections)** : Projections composites pour la France
- **[TopoJSON](https://github.com/topojson/topojson)** : Format de donn√©es g√©ographiques optimis√©

## üöÄ D√©marrage rapide

### Pr√©requis

- Node.js version 22.12+ (recommand√©)
- pnpm (gestionnaire de paquets)

### Installation

```bash
# Cloner le projet
git clone <url-du-repo>
cd cartos-resp

# Installer les d√©pendances
pnpm install

# Lancer le serveur de d√©veloppement
pnpm dev
```

Le projet sera accessible √† l'adresse [http://localhost:5173](http://localhost:5173)

### Build de production

```bash
pnpm build
```

## üìÅ Structure du projet

```
src/
‚îú‚îÄ‚îÄ cartographer/
‚îÇ   ‚îî‚îÄ‚îÄ FranceCartographer.ts    # Classe principale de cartographie
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ FranceGeoDataService.ts  # Gestion des donn√©es g√©ographiques
‚îÇ   ‚îî‚îÄ‚îÄ GeoProjectionService.ts  # Service des projections g√©ographiques
‚îú‚îÄ‚îÄ styles.css                   # Styles CSS
‚îî‚îÄ‚îÄ main.ts                      # Point d'entr√©e de l'application
```

## üó∫Ô∏è Fonctionnalit√©s principales

### 1. Vue unifi√©e personnalisable

**Carte interactive avec contr√¥les de positionnement en temps r√©el**

- Sliders pour ajuster la position X/Y de chaque territoire d'outre-mer (-15 √† +15, -10 √† +10)
- Contr√¥le du scale (√©chelle) de 0.5x √† 2.0x pour chaque territoire
- Aper√ßu en temps r√©el des modifications
- **üÜï Export de projection** : G√©n√©rez du code TypeScript ou JSON √† partir de votre configuration

### 2. Projection composite automatique

**Utilise les projections d3-composite-projections**

- **Albers France** : Projection conique √©quivalente avec repositionnement automatique
- **Conic Conformal France** : Projection conforme avec DOM-TOM pr√©-positionn√©s
- Rendu optimis√© pour la France avec tous ses territoires

### 3. Vues territoriales individuelles

**Cartes s√©par√©es pour chaque territoire**

- France m√©tropolitaine avec projection optimis√©e
- 11 territoires d'outre-mer avec projections Mercator individuelles
- Grille responsive avec DaisyUI

## üéØ Syst√®me d'export de projection

### Fonctionnement

1. **Configuration visuelle** : Utilisez les sliders dans l'onglet "Vue unifi√©e personnalisable"
2. **Aper√ßu temps r√©el** : La carte se met √† jour instantan√©ment
3. **Export** : Cliquez sur "üó∫Ô∏è Exporter la projection"
4. **Choix du format** :
   - **TypeScript (.ts)** : Fonction de projection pr√™te √† l'emploi, similaire √† `ConicConformalFrance`
   - **JSON (.json)** : Configuration pure pour persistence ou import
5. **Actions** : Copiez ou t√©l√©chargez le code g√©n√©r√©

### Utilisation du code export√©

```typescript
// Fichier g√©n√©r√© : custom-projection.ts
import customCompositeProjection from './custom-projection'

// Utilisation identique √† d3-composite-projections
const projection = customCompositeProjection()
  .scale(2700)
  .translate([width / 2, height / 2])

// Utilisable directement avec Observable Plot ou D3.js
Plot.plot({
  projection,
  marks: [Plot.geo(data, { fill: 'steelblue' })]
})
```

### Param√®tres de mapping

Le syst√®me convertit automatiquement vos param√®tres visuels en code de projection :

| Param√®tre UI | Param√®tre D3 | Description |
|--------------|--------------|-------------|
| `translateX` (-15 √† +15) | `coeffX * k` | Position horizontale relative au scale |
| `translateY` (-10 √† +10) | `coeffY * k` | Position verticale relative au scale |
| `scale` (0.5 √† 2.0) | `baseScale * multiplier` | Taille relative du territoire |

## üé® Architecture Vue.js

### Stores Pinia

- **`useConfigStore`** : Configuration globale (th√®me, projection, territoires)
  - `territoryTranslations`: Position X/Y de chaque territoire
  - `territoryScales`: √âchelle de chaque territoire
  - `selectedProjection`: Projection active
  - `territoryMode`: Mode d'inclusion des territoires

- **`useGeoDataStore`** : Donn√©es g√©ographiques et rendu
  - Chargement des TopoJSON
  - Repositionnement des territoires
  - Rendering via Cartographer

### Composants Vue

- **`App.vue`** : Layout principal avec tabs DaisyUI
- **`MapRenderer.vue`** : Composant g√©n√©rique et polyvalent pour tous les types de cartes (simple, vue-composite, projection-composite)
- **`TerritoryControls.vue`** : Sliders de contr√¥le pour repositionnement des territoires
- **`ProjectionExporter.vue`** : Modal d'export avec preview (TypeScript/JSON)
- **`ProjectionPreview.vue`** : Aper√ßu en temps r√©el de la projection g√©n√©r√©e

## üìä Donn√©es g√©ographiques

Le projet utilise maintenant **de vraies donn√©es g√©ographiques** issues de Natural Earth :

- **Source** : [Natural Earth v5.1.2](https://www.naturalearthdata.com/)
- **R√©solution** : 50m (√©quilibre entre pr√©cision et taille des fichiers)
- **Format** : TopoJSON optimis√©
- **Mise √† jour** : Automatique via script de t√©l√©chargement

### Pr√©paration des donn√©es

```bash
# T√©l√©charger et traiter les donn√©es Natural Earth
pnpm run prepare-data
```

Ce script :
1. T√©l√©charge les donn√©es mondiales Natural Earth
2. Filtre les territoires fran√ßais (m√©tropole + DOM-TOM)
3. Optimise le format TopoJSON
4. G√©n√®re les m√©tadonn√©es (superficies, codes, etc.)

### Territoires couverts

| Territoire | Code | Superficie (km¬≤) |
|------------|------|------------------|
| France m√©tropolitaine | FR-MET | 543 965 |
| Guadeloupe | FR-GP | 1 628 |
| Martinique | FR-MQ | 1 128 |
| Guyane | FR-GF | 83 534 |
| La R√©union | FR-RE | 2 512 |
| Mayotte | FR-YT | 374 |
| Saint-Pierre-et-Miquelon | FR-PM | 242 |
| Wallis-et-Futuna | FR-WF | 142 |
| Polyn√©sie fran√ßaise | FR-PF | 4 167 |
| Nouvelle-Cal√©donie | FR-NC | 18 575 |

## üîß D√©veloppement

### Architecture

Le projet suit une architecture modulaire avec s√©paration des responsabilit√©s :

- **FranceCartographer** : Orchestration et rendu des cartes
- **GeoProjectionService** : Gestion des projections g√©ographiques
- **FranceGeoDataService** : Chargement et manipulation des donn√©es

### Extension

Pour ajouter de nouvelles fonctionnalit√©s :

1. **Nouvelles projections** : √âtendre `GeoProjectionService`
2. **Nouveaux territoires** : Modifier `FranceGeoDataService`
3. **Nouveaux types de visualisation** : √âtendre `FranceCartographer`

### Tests

```bash
# Lancer les tests (√† impl√©menter)
pnpm test
```

## ü§ù Contribution

Les contributions sont les bienvenues ! Pour contribuer :

1. Forker le projet
2. Cr√©er une branche pour votre fonctionnalit√©
3. Commiter vos changements
4. Pousser vers la branche
5. Ouvrir une Pull Request

## üìÑ License

Ce projet est sous license MIT. Voir le fichier `LICENSE` pour plus de d√©tails.

## üôè Remerciements

- [Observable](https://observablehq.com/) pour les biblioth√®ques de visualisation
- [Mike Bostock](https://bost.ocks.org/mike/) pour D3.js
- La communaut√© des d√©veloppeurs de cartographie web

---

*D√©velopp√© avec ‚ù§Ô∏è pour une meilleure repr√©sentation cartographique de la France*
